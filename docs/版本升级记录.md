[TOC]

# V5.0.2.1版本修改

## 数据库
- 创建表格 `yzy_menu_permission`
```
CREATE TABLE `yzy_menu_permission` (
  `id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT 'ID',
  `pid` bigint(20) DEFAULT NULL COMMENT '上级菜单ID',
  `type` int(11) DEFAULT NULL COMMENT '菜单类型',
  `title` varchar(255) DEFAULT NULL COMMENT '菜单标题',
  `name` varchar(255) DEFAULT NULL COMMENT '组件名称',
  `component` varchar(255) DEFAULT NULL COMMENT '组件',
  `bread_num` tinyint(1) DEFAULT NULL COMMENT '面包屑层级',
  `menu_sort` int(5) DEFAULT NULL COMMENT '排序',
  `icon_show` varchar(255) DEFAULT NULL COMMENT '图标展示',
  `icon_click` varchar(255) DEFAULT NULL COMMENT '图标点击',
  `path` varchar(255) DEFAULT NULL COMMENT '链接地址',
  `redirect` varchar(255) DEFAULT NULL COMMENT '设置默认打开的页面',
  `login` tinyint(1) DEFAULT 1 COMMENT '是否需要登录',
  `hidden` tinyint(1) NOT NULL DEFAULT 0 COMMENT '隐藏',
  `permission` varchar(255) DEFAULT NULL COMMENT '权限',
  `deleted` bigint(20) NOT NULL DEFAULT 0,
  `deleted_at` varchar(255) DEFAULT NULL COMMENT '删除时间',
  `created_at` datetime DEFAULT NULL COMMENT '创建时间',
  `updated_at` datetime DEFAULT NULL COMMENT '更新时间',
  PRIMARY KEY (`id`),
  KEY `inx_pid` (`pid`),
  KEY `uniq_name` (`name`),
  KEY `uniq_title` (`title`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 ROW_FORMAT=COMPACT COMMENT='系统菜单';
# 下面是要插入的数据
insert  into `yzy_menu_permission`(`id`,`pid`,`type`,`title`,`name`,`component`,`bread_num`,`menu_sort`,`icon_show`,`icon_click`,`path`,`redirect`,`login`,`hidden`,`permission`,`deleted`,`deleted_at`,`created_at`,`updated_at`) values
(1,NULL,1,'首页','home','home/home',0,NULL,'../assets/images/home_n.png','../assets/images/home_p.png','/home/home',NULL,1,0,'home',0,NULL,NULL,NULL),
(2,NULL,1,'资源管理','resManagement',NULL,NULL,NULL,'/assets/navIcon/ziyuan_n.png','/assets/navIcon/ziyuan_p.png',NULL,NULL,1,0,'resMge',0,NULL,NULL,NULL),
(3,NULL,1,'教学桌面管理','teachDesktopManage',NULL,NULL,NULL,'/assets/navIcon/jiaoxuetable_n.png','/assets/navIcon/jiaoxuetable_p.png',NULL,NULL,1,0,'teachDeskMge',0,NULL,NULL,NULL),
(4,NULL,1,'个人桌面管理','personalDesktopManage',NULL,NULL,NULL,'/assets/navIcon/peple-table_n.png','/assets/navIcon/peple-table_p.png',NULL,NULL,1,0,'perDeskMge',0,NULL,NULL,NULL),
(5,NULL,1,'监控管理','monitor',NULL,NULL,NULL,'/assets/images/jiankong_n.png','/assets/images/jiankong_p.png',NULL,NULL,1,0,'monitorMge',0,NULL,NULL,NULL),
(6,NULL,1,'终端管理','terminalManage',NULL,NULL,NULL,'/assets/images/zhongduan_n.png','/assets/images/zhongduan_p.png',NULL,NULL,1,0,'terminalMge',0,NULL,NULL,NULL),
(7,NULL,1,'系统管理','systemManage',NULL,NULL,NULL,'/assets/images/xitong_n.png','/assets/images/xitong_p.png',NULL,NULL,1,0,'systemMge',0,NULL,NULL,NULL),
(8,2,1,'主控管理','masterControlManagement','resManagement/masterControlManagement',1,NULL,NULL,NULL,'/resManagement/masterControlManagement',NULL,1,0,'resMge:masterMge',0,NULL,NULL,NULL),
(9,2,3,'资源池管理','resPoolManagement','resManagement/resPoolManagement',1,NULL,NULL,NULL,'/resManagement/resPoolManagement',NULL,1,0,'resMge:resPoolMge',0,NULL,NULL,NULL),
(10,2,1,'网络管理','networkManagement','resManagement/networkManagement',1,NULL,NULL,NULL,'/resManagement/networkManagement',NULL,1,0,'resMge:networkMge',0,NULL,NULL,NULL),
(11,2,1,'ISO库','isoLibrary','resManagement/isoLibrary',1,NULL,NULL,NULL,'/resManagement/isoLibrary',NULL,1,0,'resMge:isoLib',0,NULL,NULL,NULL),
(15,8,2,'本地网络','localNetwork',NULL,NULL,NULL,NULL,NULL,NULL,NULL,1,0,NULL,0,NULL,NULL,NULL),
(16,8,2,'服务','service',NULL,NULL,NULL,NULL,NULL,NULL,NULL,1,0,NULL,0,NULL,NULL,NULL),
(17,8,2,'模板磁盘文件','diskFile',NULL,NULL,NULL,NULL,NULL,NULL,NULL,1,0,NULL,0,NULL,NULL,NULL),
(18,8,2,'存储配置','stoarge',NULL,NULL,NULL,NULL,NULL,NULL,NULL,1,0,NULL,0,NULL,NULL,NULL),
(19,9,4,'基础镜像','baseImage','resManagement/jumpPage/baseImage',2,NULL,NULL,NULL,'/resManagement/jumpPage/baseImage/:uuid/:name',NULL,1,0,'resMge:resPoolMge:baseImage',0,NULL,NULL,NULL),
(20,10,2,'数据网络','dataNetwork',NULL,NULL,NULL,NULL,NULL,NULL,NULL,1,0,NULL,0,NULL,NULL,NULL),
(21,10,2,'分布式虚拟交换机','distributedVirtualSwitch',NULL,NULL,NULL,NULL,NULL,NULL,NULL,1,0,NULL,0,NULL,NULL,NULL),
(22,10,2,'管理网络','manageNetwork',NULL,NULL,NULL,NULL,NULL,NULL,NULL,1,0,NULL,0,NULL,NULL,NULL),
(23,3,2,'VDI场景','teachDesktopVDI',NULL,NULL,NULL,NULL,NULL,NULL,NULL,1,0,NULL,0,NULL,NULL,NULL),
(24,3,2,'VOI场景','teachDesktopVOI',NULL,NULL,NULL,NULL,NULL,NULL,NULL,1,0,NULL,0,NULL,NULL,NULL),
(25,23,1,'教学模板','teachTem','teachDesktopManage/teachTem',1,NULL,NULL,NULL,'/teachDesktopManage/teachTem',NULL,1,0,'teachDeskMge:teachTem',0,NULL,NULL,NULL),
(26,24,5,'教学模板','teachTem','teachDesktopManage/teachTem',1,NULL,NULL,NULL,'/teachDesktopManage/teachTem',NULL,1,0,'teachDeskMge:teachTem',0,NULL,NULL,NULL),
(27,23,1,'教学分组','teachgroup','teachDesktopManage/teachgroup',1,NULL,NULL,NULL,'/teachDesktopManage/teachgroup',NULL,1,0,'teachDeskMge:teachGroup',0,NULL,NULL,NULL),
(28,24,5,'教学分组','teachgroup','teachDesktopManage/teachgroup',1,NULL,NULL,NULL,'/teachDesktopManage/teachgroup',NULL,1,0,'teachDeskMge:teachGroup',0,NULL,NULL,NULL),
(29,23,1,'教学桌面组','teachDeskGroup','teachDesktopManage/teachDeskGroup',1,NULL,NULL,NULL,'/teachDesktopManage/teachDeskGroup',NULL,1,0,'teachDeskMge:teachDeskGroup',0,NULL,NULL,NULL),
(30,24,5,'教学桌面组','teachDeskGroup','teachDesktopManage/teachDeskGroup',1,NULL,NULL,NULL,'/teachDesktopManage/teachDeskGroup',NULL,1,0,'teachDeskMge:teachDeskGroup',0,NULL,NULL,NULL),
(31,4,1,'个人模板','personalTem','personalDesktopManage/personalTem',1,NULL,NULL,NULL,'/personalDesktopManage/personalTem',NULL,1,0,'perDeskMge:personalTem',0,NULL,NULL,NULL),
(32,4,1,'用户管理','userManage','personalDesktopManage/userManage',1,NULL,NULL,NULL,'/personalDesktopManage/userManage',NULL,1,0,'perDeskMge:userMge',0,NULL,NULL,NULL),
(33,4,1,'个人桌面组','personalDeskGroup','personalDesktopManage/personalDeskGroup',1,NULL,NULL,NULL,'/personalDesktopManage/personalDeskGroup',NULL,1,0,'perDeskMge:perDeskGroup',0,NULL,NULL,NULL),
(34,6,1,'终端列表','terminalManageList','terminalManage/terminalManageList',1,NULL,NULL,NULL,'/terminalManage/terminalManageList',NULL,1,0,'terminalMge:terminalList',0,NULL,NULL,NULL),
(35,34,2,'VDI场景','terminalVDI',NULL,NULL,NULL,NULL,NULL,NULL,NULL,1,0,NULL,0,NULL,NULL,NULL),
(36,34,2,'VOI场景','terminalVOI',NULL,NULL,NULL,NULL,NULL,NULL,NULL,1,0,NULL,0,NULL,NULL,NULL),
(37,7,1,'系统桌面','systemDesktop','systemManage/systemDesktop',1,NULL,NULL,NULL,'/systemManage/systemDesktop',NULL,1,0,'systemMge:systemDesktop',0,NULL,NULL,NULL),
(38,7,1,'策略设置','strategySet','systemManage/strategySet',1,NULL,NULL,NULL,'/systemManage/strategySet',NULL,1,0,'systemMge:strategySet',0,NULL,NULL,NULL),
(39,7,1,'数据库备份','databaseBackup','systemManage/databaseBackup',1,NULL,NULL,NULL,'/systemManage/databaseBackup',NULL,1,0,'systemMge:dbBackup',0,NULL,NULL,NULL),
(40,7,1,'管理员管理','administratorManagement','systemManage/administratorManagement',1,NULL,NULL,NULL,'/systemManage/administratorManagement',NULL,1,0,'systemMge:adminMge',0,NULL,NULL,NULL),
(41,7,1,'定时任务','timingTask','systemManage/timingTask',1,NULL,NULL,NULL,'/systemManage/timingTask',NULL,1,0,'systemMge:timingTask',0,NULL,NULL,NULL),
(42,7,3,'日志管理','logManagement','systemManage/logManagement',1,NULL,NULL,NULL,'/systemManage/logManagement',NULL,1,0,'systemMge:logMge',0,NULL,NULL,NULL),
(43,7,3,'授权与服务','authorization','systemManage/authorization',1,NULL,NULL,NULL,'/systemManage/authorization',NULL,1,0,'systemMge:authMge',0,NULL,NULL,NULL),
(44,7,1,'升级管理','upgradeManagement','systemManage/upgradeManagement',1,NULL,NULL,NULL,'/systemManage/upgradeManagement',NULL,1,0,'systemMge:upgradeMge',0,NULL,NULL,NULL),
(45,38,2,'VDI场景','strategySetVDI',NULL,NULL,NULL,NULL,NULL,NULL,NULL,1,0,NULL,0,NULL,NULL,NULL),
(46,38,2,'VOI场景','strategySetVOI',NULL,NULL,NULL,NULL,NULL,NULL,NULL,1,0,NULL,0,NULL,NULL,NULL),
(47,40,2,'角色管理','roleManager',NULL,NULL,NULL,NULL,NULL,NULL,NULL,1,0,NULL,0,NULL,NULL,NULL),
(48,40,2,'管理员列表','adminList',NULL,NULL,NULL,NULL,NULL,NULL,NULL,1,0,NULL,0,NULL,NULL,NULL),
(49,41,2,'桌面定时开关机','desktopTimingSwitch',NULL,NULL,NULL,NULL,NULL,NULL,NULL,1,0,NULL,0,NULL,NULL,NULL),
(50,41,2,'主机定时开关机','nodeTimingSwitch',NULL,NULL,NULL,NULL,NULL,NULL,NULL,1,0,NULL,0,NULL,NULL,NULL),
(51,41,2,'终端定时关机','terminalTimingSwitch',NULL,NULL,NULL,NULL,NULL,NULL,NULL,1,0,NULL,0,NULL,NULL,NULL),
(52,42,2,'警告日志','warningLog',NULL,NULL,NULL,NULL,NULL,NULL,NULL,1,0,NULL,0,NULL,NULL,NULL),
(53,42,2,'操作日志','operationLog',NULL,NULL,NULL,NULL,NULL,NULL,NULL,1,0,NULL,0,NULL,NULL,NULL),
(54,42,2,'系统日志导出','systemLogExport',NULL,NULL,NULL,NULL,NULL,NULL,NULL,1,0,NULL,0,NULL,NULL,NULL),
(55,23,4,'详情','teachDeskGroupDeatil','teachDesktopManage/teachDeskGroupDeatil',2,NULL,NULL,NULL,'/teachDesktopManage/teachDeskGroupDeatil/:id',NULL,1,0,'teachDesktopManage:teachDeskGroupDeatil',0,NULL,NULL,NULL),
(56,24,4,'详情','teachDeskGroupDeatil','teachDesktopManage/teachDeskGroupDeatilVoi',2,NULL,NULL,NULL,'/teachDesktopManage/teachDeskGroupDeatilVoi/:id',NULL,1,0,'teachDesktopManage:teachDeskGroupDeatil',0,NULL,NULL,NULL),
(57,33,4,'详情','personalDeskGroupDeatil','personalDesktopManage/personalDeskGroupDeatil',2,NULL,NULL,NULL,'/personalDesktopManage/personalDeskGroupDeatil/:id',NULL,1,0,'personalDesktopManage:personalDeskGroupDeatil',0,NULL,NULL,NULL),
(58,9,4,'计算节点','computeNode','resManagement/jumpPage/computeNode',2,NULL,NULL,NULL,'/resManagement/jumpPage/computeNode/:uuid/:name',NULL,1,0,'resManagement:computeNode',0,NULL,NULL,NULL),
(59,9,4,'节点信息','nodeToMaster','resManagement/jumpPage/nodeToMaster',2,NULL,NULL,NULL,'/resManagement/jumpPage/nodeToMaster',NULL,1,0,'resManagement:nodeToMaster',0,NULL,NULL,NULL),
(60,40,4,'添加成员','addMembers','systemManage/jumpPage/addMembers',2,NULL,NULL,NULL,'/systemManage/jumpPage/addMembers',NULL,1,0,'systemManage:addMembers',0,NULL,NULL,NULL),
(61,40,4,'编辑成员','editMembers','systemManage/jumpPage/editMembers',2,NULL,NULL,NULL,'/systemManage/jumpPage/editMembers',NULL,1,0,'systemManage:editMembers',0,NULL,NULL,NULL),
(62,43,2,'激活','authActivation',NULL,NULL,NULL,NULL,NULL,NULL,NULL,1,0,NULL,0,NULL,NULL,NULL),
(63,40,4,'权限设置','setAuthority','systemManage/jumpPage/set-authority',2,NULL,NULL,NULL,'/systemManage/jumpPage/setAuthority',NULL,1,0,'systemManage:setAuthority',0,NULL,NULL,NULL),
(64,5,1,'主机监控','hostMonitor','monitor/hostMonitor',1,NULL,NULL,NULL,'/monitor/hostMonitor',NULL,1,0,'monitor:hostMonitor',0,NULL,NULL,NULL);
```
## 服务器

- 开放端口6881-6889
- ukey_server和ukey python代码的重新生成

## yzy_kvm.ini配置文件

## 虚拟机xml文件修改

## 解决bug

```
KVM-1001
KVM-1013
KVM-1011
KVM-955
KVM-953
KVM-1047
KVM-1038
KVM-1043
KVM-1042
KVM-1046
KVM-1040
KVM-1039
KVM-1023
KVM-1034
KVM-1014
KVM-1041
KVM-1022
KVM-1017
KVM-1016
KVM-1015
```

## 新增功能

- 权限管理
- 主机监控

